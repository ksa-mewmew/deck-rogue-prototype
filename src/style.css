/* =========================================================
   FINAL style.css (DEDUPED + REORDERED)
   - ì¤‘ë³µ ì •ì˜ ì œê±°: ë™ì¼ ëª©ì /ë³€ìˆ˜/ì…€ë ‰í„°ëŠ” "ì•„ë˜ìª½ ê°’"ë§Œ ìœ ì§€
   - :rootëŠ” 1ê°œë¡œ í†µí•© (í† í° ì‹±ê¸€ ì†ŒìŠ¤)
   - ì„¹ì…˜ ìˆœì„œ ì •ë¦¬ + í•œê¸€ ì£¼ì„ ì¶”ê°€
   ========================================================= */


/* =========================
   0) ROOT TOKENS (SINGLE SOURCE OF TRUTH)
   - UI ìŠ¤ì¼€ì¼, ë ˆì´ì–´, ìƒ‰, ë ˆì´ì•„ì›ƒ, íŠ¸ë ˆì´/í† ìŠ¤íŠ¸ ë“± ì „ì—­ í† í°
   ========================= */
:root{
  /* ---------- UI SCALE ---------- */
  --uiScale: 1;
  --uiScaleDesktop: 1;
  --uiScaleMobile: 1;

  /* ---------- SAFE AREA (length) ---------- */
  --safeT: env(safe-area-inset-top, 0);
  --safeR: env(safe-area-inset-right, 0);
  --safeB: env(safe-area-inset-bottom, 0);
  --safeL: env(safe-area-inset-left, 0);

  /* ---------- DESIGN UNIT (design-pixel to viewport) ---------- */
  --uBase: min(calc(100vw / 1440), calc(100vh / 900));
  --u: calc(var(--uBase) * var(--uiScale));

  /* ---------- ANIMATION SPEED ---------- */
  --animMul: 1;  /* 0=ì¦‰ì‹œ, 1=ê¸°ë³¸, 2=ëŠë¦¼ */

  /* ---------- Z-LAYERS ---------- */
  --zBg: -10;
  --zStatus: 10;         /* status bar region (ë°°ê²½ ë°”ë¡œ ìœ„) */
  --zMain: 1000;
  --zHandDock: 2000;

  --zChrome: 60000;      /* í•­ìƒ í´ë¦­ ê°€ëŠ¥í•œ í¬ë¡¬/ê³ ì • UI */
  /* Choice overlay (must sit above player HUD / chrome) */
  --zChoiceBackdrop: 60000;
  --zChoicePanel: 62000;
  --zChoice: 63000;

  --zRelicHud: 65000;
  --zRelicModal: 70000;

  --zRulebook: 71000;
  --zLogOverlay: 79000;
  --zSettings: 80000;
  --zDevConsole: 100000;

  /* ---------- THEME ---------- */
  --bg0:#060708;
  --bg1:#0b0d10;
  --panel:#0f1216cc;
  --panel2:#0f1216f0;
  --line:#ffffff14;
  --line2:#ffffff1f;
  --text:#e7e9ee;
  --muted:#b7bdc8;

  /* ---------- LAYOUT (scale-aware) ---------- */
  --edgePad: calc(14 * var(--u));
  --logW:   calc(360 * var(--u));
  --logGap: calc(14 * var(--u));

  /* HUD ë†’ì´ / ë„í¬ ë†’ì´ */
  --hudH:  calc(64 * var(--u));
  --dockH: calc(160 * var(--u));

  /* ìŠ¤í…Œì´ì§€(ë³´ë“œ) ìµœëŒ€ í­ / ë³´ë“œ ë¹„ìœ¨ */
  --stageMaxW: calc(760 * var(--u));
  --boardAR: 1200/922;

  /* ---------- CARDS + SLOTS ---------- */
  --cardW: calc(122 * var(--u));
  --cardH: calc(var(--cardW) * 7 / 5);
  --handCardW: var(--cardW);
  --handCardH: var(--cardH);

  --boardScale: 1;

  /* ë³´ë“œ ì´ë¯¸ì§€ ë³´ì • */
  --boardImgZoom: 1.1;
  --boardImgPosY: 32%;
  --boardImgShiftY: calc(34 * var(--u));

  /* ìŠ¬ë¡¯ í¬ê¸°(ë³´ë“œ ìœ„ ì¹´ë“œ) */
  --slotCardW: calc(110 * var(--u) * var(--boardScale));
  --slotCardH: calc(var(--slotCardW) * 7 / 5);

  --slotPad: calc(6 * var(--u));
  --slotW: calc(var(--slotCardW) + (var(--slotPad) * 2));
  --slotH: calc(var(--slotCardH) + (var(--slotPad) * 2));
  --slotGap: calc(12 * var(--u) * var(--boardScale));
  --slotRowGap: calc(2 * var(--u));

  --boardPadX: calc(56 * var(--u));
  --boardPadY: calc(34 * var(--u));

  /* ìŠ¬ë¡¯ ì „ì²´ë¥¼ ì•½ê°„ ìœ„ë¡œ ì˜¬ë¦¬ëŠ” ë¯¸ì„¸ ë³´ì • */
  --slotCenterNudgeY: calc(50 * var(--u));

  /* ---------- RADII / SHADOW ---------- */
  --radius: calc(18 * var(--u));
  --selR: calc(8 * var(--u));
  --shadow: 0 calc(18 * var(--u)) calc(60 * var(--u)) rgba(0,0,0,.65);

  /* ---------- HUD PANEL LOOK ---------- */
  --hudPanelBg: rgba(10,12,14,1);
  --hudPanelLine: rgba(255,255,255,.14);
  --hudPanelR: calc(18 * var(--u));

  /* ---------- LOGS ---------- */
  --logLine: rgba(255,255,255,.22);
  --logLineStrong: rgba(255,255,255,.32);
  --logShadow: 0 calc(18 * var(--u)) calc(60 * var(--u)) rgba(0,0,0,.70);
  --logBg: rgba(0,0,0,.75);

  /* ---------- ASSETS ---------- */
  --bgUrl: url("assets/ui/background/dungeon_bg.png");
  --boardUrl: url("assets/ui/boards/battle_board.png");
  --mapBgUrl: url("assets/ui/background/map_bg.png");

  /* ---------- CARD BACKGROUNDS (rarity) ---------- */
  --cardBgBasic:   url("assets/ui/cards/card_basic.png");
  --cardBgCommon:  url("assets/ui/cards/card_common.png");
  --cardBgSpecial: url("assets/ui/cards/card_special.png");
  --cardBgRare:    url("assets/ui/cards/card_rare.png");
  --cardBgMadness: url("assets/ui/cards/card_madness.png");

  /* ê¸°ë³¸ ë°°ê²½(ë¯¸ì„¤ì¹˜ ì‹œì—ëŠ” ê¸°ì¡´ parchmentë¥¼ ë³µì‚¬í•´ ìœ„ íŒŒì¼ëª…ë“¤ë¡œ ë‘ì…”ë„ ë©ë‹ˆë‹¤) */
  --cardUrl: var(--cardBgCommon, url("assets/ui/cards/card_parchment.png"));

  /* ---------- ENEMY HUD ---------- */
  --enemyBannerW: calc(360 * var(--u));
  --enemyHudDx: 0;

  /* ---------- DOCK ---------- */
  --dockDrop:        calc(0 * var(--u));
  --dockContentDrop: calc(0 * var(--u));

  /* ---------- HP BARS ---------- */
  --hpH: calc(10 * var(--u));
  --hpSeg: calc(6 * var(--u));
  --hpBorder: rgba(0,0,0,.65);
  --hpFrame: rgba(255,255,255,.18);

  /* ---------- STAGE CORNER / HINTS ---------- */
  --hudTop: calc(150 * var(--u));
  --hintGap: calc(20 * var(--u));
  --targetHintTop: calc(70 * var(--u));

  /* ---------- CHOICE OVERLAY ---------- */
  --choicePadTop: calc(180 * var(--u));
  --choicePadR:   calc(36 * var(--u));
  --choicePadB:   calc(12 * var(--u));
  --choicePadL:   calc(12 * var(--u));

  --choicePanelW: calc(760 * var(--u));
  --choicePanelPad: calc(16 * var(--u));
  --choicePanelR: calc(16 * var(--u));

  --choiceRowGap: calc(18 * var(--u));
  --choiceListGap: calc(10 * var(--u));

  --choiceIlluSize: calc(260 * var(--u));
  --choiceIlluMin:  calc(200 * var(--u));

  /* Dx/DyëŠ” ìˆ«ì í† í°(ì„¤ê³„ ë‹¨ìœ„). ë³€í™˜ ì‹œ --uë¥¼ ê³±í•´ uiScale ì¤‘ë³µì„ ë°©ì§€ */
  --choicePanelDx: 0;
  --choicePanelDy: 40;
  --choicePanelMarginY: 24;

  /* ---------- PLAYER HUD POSITION ---------- */
  --playerHudLeftX: calc(var(--safeL) + var(--edgePad));
  --playerHudTop:   calc(var(--safeT) + calc(480 * var(--u)));

  /* íŠ¸ë ˆì´ ì´ë™ëŸ‰ê³¼ ì—°ë™ë˜ëŠ” ë“œë¡­(ìµœì¢… ê·œì¹™: trayRaiseì˜ ì—­ê°’) */
  --trayRaise: calc(-1 * var(--u));
  --playerHudDropY: calc(9rem);
  --stageCornerLiftY: calc(-1 * var(--trayRaise));

  --statusBarGap: calc(30 * var(--u));

  /* ---------- NODE UI ---------- */
  --gap: calc(6 * var(--u));
  --colNow:   calc(70 * var(--u));
  --colArrow: calc(22 * var(--u));
  --colNext:  calc(70 * var(--u));
  --colSlash: calc(18 * var(--u));

  /* ---------- RELICS (ê¸°ë³¸ í† í°) ---------- */
  --relicImgZoom: 1.3;

  /* ---------- ENEMY CARDS ---------- */
  --enemyCardW: calc(160 * var(--u));
  --enemyCardH: calc(var(--enemyCardW) * 7 / 5);
  --enemyArtH:  calc(420 * var(--u));
  --enemyHudW: calc(208 * var(--u));

  /* ---------- MAP TOKENS ---------- */
  --mapPanelCX: 50%;
  --mapPanelCY: 50%;
  --mapPanelDX: 0%;
  --mapPanelDY: -24%;

  /* Base sizes (numbers); ì´ë¦„ì€ Pxì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” --uë¡œ ìŠ¤ì¼€ì¼ */
  --panelInsetPx: 3;
  --panelMaxInsetPx: 60;
  --panelMaxWidthPx: 800;

  --gridGapPx: 16;
  --sideColWidthPx: 380;

  --boxPadPx: 14;
  --boxRadiusPx: 14;
  --scrollerRadiusPx: 12;

  --mapSvgScale: 1.0;
  --mapSvgDX: 0%;
  --mapSvgDY: 0%;

  --mapBgDim: 0;
  --mapBgOpacity: 0;
  --mapHeaderSafeTopPx: 12;
  --mapHeaderSafeSidePx: 14;

  --mapPanelMaxHPx: 900;
  --mapScrollerMinHPx: 520;

  --pillarPx: 90;
  --pillarW: calc(var(--pillarPx) * var(--u));

  /* ---------- SHOP COMPACT TOKENS ---------- */
  --shopPanelW:    calc(700 * var(--u));
  --shopSvcW:      calc(240 * var(--u));
  --shopSvcGap:    calc(8 * var(--u));
  --shopItemSize:  calc(76 * var(--u));
  --shopItemIcon:  calc(50 * var(--u));

  /* ---------- TOAST TOKENS (ìŠ¤íƒ€ì¼ìš©) ---------- */
  --toastGap:   calc(8 * var(--u));
  --toastPadY:  calc(8 * var(--u));
  --toastPadX:  calc(12 * var(--u));
  --toastR:     calc(10 * var(--u));
  --toastFont:  calc(25 * var(--u));
  --toastMaxW:  calc(380 * var(--u));

  /* ---------- ì•„ì´í…œ/ë ë¦­ ê³µí†µ íŠ¸ë ˆì´ í† í° (ìµœì¢… v4 ìŠ¹ì) ---------- */
  --trayCols: 4;
  --trayRowsMax: 3;

  --traySlot: calc(72 * var(--u));
  --trayGap:  calc(10 * var(--u));
  --trayPad:  calc(10 * var(--u));

  /* í™”ë©´ ê°€ì¥ìë¦¬ ê¸°ë³¸ ì—¬ë°± + ì¶”ê°€ ì•ˆìª½ ì´ë™(ì–‘ìª½ ëŒ€ì¹­) */
  --traySidePad: calc(22 * var(--u));
  --trayInwardX: calc(14 * var(--u)); /* (+) => ì•„ì´í…œì€ ë” ì˜¤ë¥¸ìª½, ë ë¦­ì€ ë” ì™¼ìª½ìœ¼ë¡œ(ì¤‘ì•™ ìª½) */

  /* íŠ¸ë ˆì´ ë°”ë‹¥ ê¸°ì¤€(ì†íŒ¨ ë„í¬ ìœ„ë¡œ) */
  --trayBottom: calc(var(--safeB) + calc(10 * var(--u)) + var(--trayRaise));

  /* ì•„ì´í…œ/ë ë¦­ ìœ„ì¹˜(ëŒ€ì¹­) */
  --itemTrayLeft:   calc(var(--safeL) + var(--traySidePad) + var(--trayInwardX));
  --relicTrayRight: calc(var(--safeR) + var(--traySidePad) + var(--trayInwardX));

  /* ê¸°ì¡´ ì½”ë“œ í˜¸í™˜ ë§¤í•‘ */
  --relicIconSize: var(--traySlot);
  --relicIconGap:  var(--trayGap);
  --relicTrayBottom: var(--trayBottom);

  --itemTrayCols:  var(--trayCols);
  --itemTrayGap:   var(--trayGap);
  --itemSlotSize:  var(--traySlot);
  --itemTrayRowsMax: var(--trayRowsMax);

  /* ---------- ì•„ì´ì½˜ í…Œë‘ë¦¬/ê¸€ë¡œìš° ---------- */
  --iconBorder: rgba(255,255,255,.28);
  --iconGlow:   rgba(210,240,255,.18);

  /* ---------- Së§Œ ë³´ì´ëŠ” HUD ---------- */
  --sHudLeft: 21rem;
  --sHudTop:  calc(var(--safeT) + var(--hudH) + calc(330 * var(--u)));
  --sHudOffX: calc(0 * var(--u));
  --sHudOffY: calc(140 * var(--u));

  --sHudFont: clamp(calc(24 * var(--u)), 4vw, calc(36 * var(--u)));
  --sHudPadY: calc(10 * var(--u));
  --sHudPadX: calc(14 * var(--u));
  --sHudR:    calc(12 * var(--u));

  /* ---------- ë‹¤ìŒ í„´ ë²„íŠ¼ ---------- */
  --combatCtrlLift: calc(10 * var(--u));

  /* ---------- TOAST ìœ„ì¹˜(ì¤‘ì•™ ê³ ì • + ë¯¸ì„¸ ì´ë™) ---------- */
  --toastCX: 50%;
  --toastCY: 50%;
  --toastDx: 0; /* ìˆ«ì(ì„¤ê³„ ë‹¨ìœ„). --u ê³±í•´ ì ìš©ë¨ */
  --toastDy: -270; /* ìˆ«ì(ì„¤ê³„ ë‹¨ìœ„). ìŒìˆ˜ë©´ ìœ„ë¡œ ì´ë™ */
}


/* Optional: font scale (ë””ìì¸ ë‹¨ìœ„ ê¸°ì¤€ ê¸°ë³¸ í°íŠ¸ ìŠ¤ì¼€ì¼) */
html{ font-size: calc(16 * var(--u)); }


/* =========================
   1) FONTS
   - ê²Œì„ í°íŠ¸ ì„¤ì¹˜ + ë¡œê·¸ëŠ” ê°€ë…ì„± í°íŠ¸ë¡œ ë¶„ë¦¬
   ========================= */
@font-face{
  font-family: "Mulmaru";
  src: url("assets/fonts/Mulmaru.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

html, body, #app, button, input, textarea, select, .choice-panel{
  font-family: "Mulmaru", ui-sans-serif, system-ui, -apple-system,
               "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif !important;
}

body{
  font-variant-numeric: tabular-nums;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

/* ë¡œê·¸ëŠ” ì‚°ì„¸ë¦¬í”„ ê³ ì •(ê°€ë…ì„±) */
pre.log,
.logPanel pre.log,
.logOverlay pre.log,
pre.log.log{
  font-family: ui-sans-serif, system-ui, -apple-system,
               "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif !important;
}


/* =========================
   2) BASE
   - ê¸°ë³¸ ë ˆì´ì•„ì›ƒ/ë°°ê²½ ì•ˆì „ì¥ì¹˜
   ========================= */
html, body{ height:100%; }

body{
  margin:0;
  color:var(--text);
  overflow:hidden;
  background: transparent;
}

#app{
  height:100vh;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  position: relative;
  z-index: var(--zMain);
  pointer-events: none;
}

/* ë°°ê²½ì´ í°ìƒ‰ìœ¼ë¡œ íŠ€ì§€ ì•Šë„ë¡ ì•ˆì „ì¥ì¹˜ */
html, body, #app,
.mainRow, .stage, .stageInner,
.combatRoot, .boardArea{
  background: transparent !important;
}

/* ì˜¤ë²„í”Œë¡œ ì•ˆì „ì¥ì¹˜ */
.battleTitleRow, .mainPanel, .stage, .stageInner{ overflow: visible !important; }


/* =========================
   3) GLOBAL BACKGROUND
   - ë˜ì „ ë°°ê²½ ì´ë¯¸ì§€ + ë¹„ë„¤íŒ…
   ========================= */
.bgLayer{
  position: fixed;
  inset: 0;
  background: var(--bgUrl) center / cover no-repeat;
  image-rendering: pixelated;
  z-index: var(--zBg) !important;
  pointer-events:none !important;
}

.bgLayer::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background: radial-gradient(ellipse at center,
    rgba(0,0,0,0.28) 0%,
    rgba(0,0,0,0.38) 55%,
    rgba(0,0,0,0.55) 100%);
}


/* =========================
   4) TOP HUD + PLAYER HUD
   - ìƒë‹¨ ë²„íŠ¼ ì˜ì—­ + ì¢Œì¸¡ í”Œë ˆì´ì–´ HUD ê³ ì •
   ========================= */
.topHud{
  height: var(--hudH);
  display: grid;
  grid-template-columns: 1fr minmax(0, var(--stageMaxW)) 1fr;
  align-items: start;
  gap: calc(10 * var(--u));
  padding: calc(6 * var(--u)) var(--edgePad) 0 var(--edgePad);
  box-sizing: border-box;
  overflow: visible;
  position: relative;
  z-index: var(--zChrome);
  pointer-events: none !important; /* ê¸°ë³¸ì ìœ¼ë¡œ ìƒë‹¨ HUDëŠ” í´ë¦­ ë¶ˆê°€, ë‚´ë¶€ì—ì„œ í´ë¦­ ê°€ëŠ¥í•œ ë¶€ë¶„ë§Œ ë”°ë¡œ ì§€ì • */
}

.topHudLeftSpacer{ pointer-events: none !important; }
.playerHudLeft, .topHudRight{ pointer-events: auto; }

/* ì˜¤ë¥¸ìª½ ìƒë‹¨ ë²„íŠ¼(í•­ìƒ í´ë¦­ ê°€ëŠ¥) */
.topHudRight{
  position: fixed;
  top:   calc(var(--safeT) + calc(8 * var(--u)));
  right: calc(var(--safeR) + calc(10 * var(--u)));
  z-index: calc(var(--zChrome)+20000);
  pointer-events: auto;
}
.topHudRight *{ pointer-events:auto; }

.enemyHud{ display: flex; gap: calc(10 * var(--u)); flex-wrap: wrap; }

/* ì¢Œì¸¡ í”Œë ˆì´ì–´ HUD */
.playerHudLeft{
  position: fixed;
  left: var(--playerHudLeftX);
  top:  calc(var(--playerHudTop) + var(--playerHudDropY));
  width: min(calc(420 * var(--u)), calc(100vw - (var(--edgePad) * 2)));
  padding: calc(14 * var(--u));
  background: var(--hudPanelBg);
  border: calc(1 * var(--u)) solid var(--hudPanelLine);
  border-radius: var(--hudPanelR);
  box-shadow: 0 calc(14 * var(--u)) calc(40 * var(--u)) rgba(0,0,0,.40);
  backdrop-filter: blur(calc(6 * var(--u)));
  -webkit-backdrop-filter: blur(calc(6 * var(--u)));
  z-index: var(--zChrome);
  pointer-events: auto;
}
.playerHudTitle{ font-size: calc(19 * var(--u)); font-weight: 900; }
.playerHudLeft *{ pointer-events:auto !important; }

.playerHudLeft .enemyBadges{
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: calc(4 * var(--u));
  min-height: calc(24 * var(--u));
}

.playerTitleRow{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: calc(10 * var(--u));
  margin-bottom: calc(10 * var(--u));
}

/* ë±/ë¬˜ì§€/ë“œë¡œìš° ë“± ë²„íŠ¼ 5ê°œë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ëª¨ìœ¼ê¸° */
.pileButtons{
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: calc(1 * var(--u));
  flex-wrap: nowrap;
}


/* =========================
   5) MAIN AREA + STAGE
   - ì¤‘ì•™ ìŠ¤í…Œì´ì§€(ë³´ë“œ) ì˜ì—­ ë°°ì¹˜
   ========================= */
.mainRow{
  position: relative;
  flex: 1;
  min-height: 0;
  box-sizing: border-box;
  overflow: hidden;
  padding-bottom: calc(var(--dockH) + calc(6 * var(--u)));
  pointer-events: auto;
}

.stage{
  height: 100%;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-top: calc(0 * var(--u));
  background: transparent;
}

.stageInner{
  width: min(var(--stageMaxW), 100%);
  max-height: 100%;
  aspect-ratio: var(--boardAR);
  display:flex;
  margin: 0 auto;
  overflow: visible;
  transform: translateY(0);
}


/* =========================
   6) MAIN PANEL (board background)
   - ì „íˆ¬ ì‹œ ë³´ë“œ ë°°ê²½ ì´ë¯¸ì§€ ë ˆì´ì–´
   ========================= */
.mainPanel{
  position: relative;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  padding: calc(210 * var(--u)) calc(12 * var(--u)) calc(12 * var(--u)) calc(12 * var(--u));
  background: transparent;
  overflow: visible;
}

/* ë³´ë“œ ì´ë¯¸ì§€ ë ˆì´ì–´(ì „íˆ¬ì—ë§Œ í‘œì‹œ) */
.mainPanel::before{
  content:"";
  position:absolute;
  inset: 0;
  pointer-events:none;
  opacity: 0;
}

.mainPanel.inCombat::before{
  opacity: 1;
  background: var(--boardUrl) center / cover no-repeat;
  image-rendering: pixelated;
  background-size: calc(100% * var(--boardImgZoom)) calc(100% * var(--boardImgZoom));
  background-position: 50% var(--boardImgPosY);
  transform: translateY(calc(210 * var(--u)));
}

/* ë³´ë“œ ìœ„ ì‹¤ì œ UIëŠ” ì´ë¯¸ì§€ ìœ„ë¡œ */
.mainPanel > *{ position: relative; }


/* =========================
   7) BOARD AREA (slots center)
   - ìŠ¬ë¡¯ ê·¸ë¦¬ë“œ ì¤‘ì‹¬ ì •ë ¬/ê°„ê²©
   ========================= */
.combatRoot,
.boardArea{
  background: transparent !important;
}

.boardArea{
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--slotRowGap);

  padding: calc(10 * var(--u));
  box-sizing: border-box;

  transform: translateY(var(--slotCenterNudgeY));
  min-height: 82%;
}

/* ì „íˆ¬ ì‹œ ë³´ë“œ ì˜ì—­ ë†’ì´(ìµœì¢… ìŠ¹ì: 86%) */
.mainPanel.inCombat .boardArea{ min-height: 86%; }

/* ìŠ¬ë¡¯ í–‰(6ì¹¸) */
.grid6{
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--slotGap);
  width: 100%;
}


/* =========================
   8) SLOTS
   - ìŠ¬ë¡¯ ë°•ìŠ¤ + ìŠ¬ë¡¯ ë‚´ë¶€ ì¹´ë“œ ìŠ¤ì¼€ì¼ë§
   ========================= */
.slot{
  position: relative;
  display: grid;
  place-items: center;
  width: var(--slotW);
  height: var(--slotH);
  border: 0 !important;
  background: transparent !important;
  border-radius: 0;
  overflow: hidden;
  --slotTextScale: 0.78;
}

/* ìŠ¬ë¡¯ ì•ˆì—ì„œ ì •ì¤‘ì•™ ë°°ì¹˜ ì»¨í…Œì´ë„ˆ */
.slotCardScaler{
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
}

/* ê¸°ì¤€ ë°•ìŠ¤(ì—¬ê¸°ì— scaleë§Œ ì ìš©) */
.slotCardInner{
  width: var(--handCardW);
  height: var(--handCardH);
  transform-origin: 50% 50%;
  transform: scale(var(--slotCardScale, 1));
  pointer-events: auto;
}

/* ìŠ¬ë¡¯ í…ìŠ¤íŠ¸ëŠ” ì¹´ë“œ ìŠ¤ì¼€ì¼ë³´ë‹¤ ì¡°ê¸ˆ ë” ì¤„ì´ê¸° */
.slot .slotCardInner{
  --slotTextScale: calc(var(--slotCardScale, 1) * 0.92);
}

.slot .card{
  font-size: calc(14 * var(--u) * var(--slotTextScale));
  line-height: 1.12;
}

/* ìŠ¬ë¡¯ ë‚´ë¶€ í…ìŠ¤íŠ¸ëŠ” em ë‹¨ìœ„ë¡œë§Œ ì¡°ì ˆ */
.slot .card .cardTitle{ font-size: 1.00em !important; line-height: 1.05 !important;}
.slot .card .cardMeta,
.slot .card .badge{ font-size: 0.80em; line-height: 1.05; }
.slot .card .cardText{ font-size: 0.8em !important; line-height: 1.15 !important; }

/* ìŠ¬ë¡¯ ë‚´ë¶€ íŒ¨ë”©ë„ emë¡œ ì¶•ì†Œ */
.slot .card .cardHeader{ padding: 0.45em 0.55em; }
.slot .card .cardBody{ padding: 0.45em 0.55em; }
.slot .card .cardSection{ padding: 0.40em; }

/* ì¹´ë“œê°€ ê¸°ì¤€ ë°•ìŠ¤ì— ê½‰ ì°¨ë„ë¡ */
.slotCardInner > .card{
  width: 100%;
  height: 100%;
}

/* ìŠ¬ë¡¯ ì˜¤ëª©í•œ ëŠë‚Œ ë ˆì´ì–´ */
.slot::before{
  content:"";
  position:absolute;
  inset: var(--slotPad);
  border-radius: 0;
  pointer-events:none;
  background: rgba(0,0,0,.50);
  box-shadow:
    inset 0 calc(12 * var(--u)) calc(18 * var(--u)) rgba(0,0,0,.65),
    inset 0 calc(-10 * var(--u)) calc(16 * var(--u)) rgba(255,255,255,.06),
    inset 0 0 0 calc(1 * var(--u)) rgba(255,255,255,.08);
  opacity: .8;
}
.slot > *{ position: relative;}

/* ìŠ¬ë¡¯ ìƒíƒœ(ë†“ì„ ìˆ˜ ìˆìŒ / ë“œë¡­ í˜¸ë²„) */
.slot.placeable::before{
  box-shadow:
    inset 0 calc(10 * var(--u)) calc(18 * var(--u)) rgba(0,0,0,.52),
    inset 0 0 0 calc(1 * var(--u)) rgba(255,255,255,.16),
    0 0 0 calc(1 * var(--u)) rgba(255,255,255,.10);
}
.slot.dropHover::before{
  box-shadow:
    inset 0 calc(10 * var(--u)) calc(18 * var(--u)) rgba(0,0,0,.52),
    inset 0 0 0 calc(1 * var(--u)) rgba(255,255,255,.22),
    0 0 0 calc(2 * var(--u)) rgba(255,255,255,.18);
}

/* ìŠ¬ë¡¯ì— ë“¤ì–´ê°„ ì¹´ë“œ ê°•ì œ í¬ê¸° */
.slot > .card,
.slot .card.inSlot{
  width: var(--slotCardW) !important;
  height: var(--slotCardH) !important;
}

.slot .card.slotNameOnly{
  --slotTextScale: calc(var(--slotCardScale, 1) * 1.25);
}

/* êµë€(ë¹„í™œì„±) ìŠ¬ë¡¯ í‘œì‹œ */
.slot.disabled{
  cursor: not-allowed;
}

/* ê¸°ë³¸ ì˜¤ëª© ë ˆì´ì–´ ìƒ‰ê°ë§Œ ì‚´ì§ ë°”ê¿”ì„œ "ì´ìƒ ìƒíƒœ" ëŠë‚Œ */
.slot.disabled::before{
  background: rgba(40, 0, 60, .55);
  box-shadow:
    inset 0 calc(12 * var(--u)) calc(18 * var(--u)) rgba(0,0,0,.70),
    inset 0 calc(-10 * var(--u)) calc(16 * var(--u)) rgba(255,255,255,.05),
    inset 0 0 0 calc(1 * var(--u)) rgba(200,140,255,.14);
  opacity: .95;
}

/* ì‚¬ì„  ë§ˆìŠ¤í¬ + ğŸŒ€ ë±ƒì§€(ìš°ìƒë‹¨) */
.slot.disabled::after{
  content: "ğŸŒ€";
  position: absolute;
  inset: var(--slotPad);
  pointer-events: none;

  display: flex;
  justify-content: flex-end;
  align-items: flex-start;
  padding: calc(6 * var(--u));

  font-size: calc(20 * var(--u));
  line-height: 1;

  color: rgba(235, 230, 255, .90);
  text-shadow: 0 0 calc(10 * var(--u)) rgba(170, 90, 255, .35);

  /* ì€ì€í•œ ì‚¬ì„  */
  background: repeating-linear-gradient(
    135deg,
    rgba(255,255,255,.08) 0,
    rgba(255,255,255,.08) calc(6 * var(--u)),
    rgba(0,0,0,0) calc(6 * var(--u)),
    rgba(0,0,0,0) calc(12 * var(--u))
  );
  opacity: .85;
}

/* ìŠ¬ë¡¯ ì•ˆ ì¹´ë“œê°€ ìˆìœ¼ë©´ ì‚´ì§ íë¦¬ê²Œ(í•„í„° ëŒ€ì‹  opacityë§Œ) */
.slot.disabled .slotCardInner{
  opacity: .82;
}

/* =========================
   9) CARDS (parchment-only)
   - ì¹´ë“œ ê¸°ë³¸ ë ˆì´ì•„ì›ƒ + í¬ê·€ë„ë³„ ë°°ê²½
   ========================= */
.card{
  position: relative;
  width: var(--handCardW);
  height: var(--handCardH);
  padding: calc(10 * var(--u)) calc(10 * var(--u));
  box-sizing: border-box;

  display:flex;
  flex-direction:column;

  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  filter: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;

  color: rgba(25,18,10,.92) !important;
  text-shadow: none !important;
}

/* ì¹´ë“œ ë°”íƒ•(íŒŒì¹˜ë¨¼íŠ¸) */
.card::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius: 0;
  background: var(--cardUrl) center / 100% 100% no-repeat !important;
  image-rendering: pixelated;
  pointer-events:none;
}
.card::after{ content:none !important; display:none !important; }
.card > *{ position: relative; }

/* í¬ê·€ë„ ë°°ê²½ ë§¤í•‘ */
.card.rarity-basic{ --cardUrl: var(--cardBgBasic); }
.card.rarity-common{ --cardUrl: var(--cardBgCommon); }
.card.rarity-special{ --cardUrl: var(--cardBgSpecial); }
.card.rarity-rare{ --cardUrl: var(--cardBgRare); }
.card.rarity-madness{ --cardUrl: var(--cardBgMadness); }

.cardHeader{
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  margin: 0 0 calc(6 * var(--u)) 0 !important;
  padding: 0 !important;
}

.cardTitle{
  text-align: center !important;
  font-family: "Mulmaru", serif !important;
  font-weight: 400 !important;
  font-size: calc(13 * var(--u)) !important;
  line-height: 1.1 !important;
  letter-spacing: -calc(0.2 * var(--u)) !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}

.cardBody{
  display:flex !important;
  flex-direction:column !important;
  gap: 0 !important;
  min-height: 0 !important;
  flex: 1 1 auto !important;
  overflow: visible !important;
}

.cardSection{
  flex: 1 1 0 !important;
  min-height: 0 !important;
  background: transparent !important;
  border: 0 !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  padding: 0 !important;
  overflow: hidden !important;
  position: relative;
}

.cardText{
  font-size: calc(11 * var(--u)) !important;
  line-height: 1.25 !important;
  letter-spacing: -calc(0.2 * var(--u)) !important;
  margin: 0 !important;
  padding: 0 !important;

  overflow: hidden !important;
  overflow-wrap: anywhere !important;
  word-break: keep-all !important;
}

/* ê´‘ê¸° ì¹´ë“œ í…ìŠ¤íŠ¸ëŠ” í°ìƒ‰ */
.card.rarity-madness,
.card.rarity-madness *{
  color: #fff !important;
}

/* ì•/ë’¤ êµ¬ë¶„ì„  */
.cardSection.front{
  position: relative;
  padding-bottom: calc(10 * var(--u));
  margin-bottom: calc(8 * var(--u));
}
.cardSection.front::after{
  content:"";
  position:absolute;
  left: calc(10 * var(--u));
  right: calc(10 * var(--u));
  bottom: 0;
  height: calc(1 * var(--u));
  background: rgba(90,60,30,.45);
  opacity: .55;
  pointer-events:none;
}

.cardSection.back{
  padding-top: calc(10 * var(--u));
  margin-top: calc(8 * var(--u));
  position: relative;
}

/* ë’¤ ì„¹ì…˜ì˜ ë³´ì¡° êµ¬ë¶„ì„  */
.cardSection.back::after{
  content: "";
  position: absolute;
  left: calc(8 * var(--u));
  right: calc(8 * var(--u));
  top: calc(-17 * var(--u));
  height: calc(1 * var(--u));
  background: rgba(110, 70, 35, .55);
  pointer-events: none;
}

/* ì„ íƒ ê°•ì¡° */
.card.selected{
  border-radius: 0 !important;
  outline: none !important;
  box-shadow:
    0 0 0 calc(2 * var(--u)) rgba(255,255,255,.60),
    0 calc(12 * var(--u)) calc(22 * var(--u)) rgba(0,0,0,.35) !important;
  transform: translateY(calc(-2 * var(--u)));
  animation-name: pickPulse;
  animation-duration: calc(160ms * var(--animMul));
  animation-timing-function: ease-out;
  animation-fill-mode: both;
}
.card.selected .cardTitle{
  text-shadow: 0 0 calc(10 * var(--u)) rgba(255,255,255,.28);
}
@keyframes pickPulse{
  0%{ transform: translateY(0); }
  40%{ transform: translateY(calc(-3 * var(--u))); }
  100%{ transform: translateY(0); }
}

/* ë“œë˜ê·¸ ì†ŒìŠ¤ */
.card.isDraggingSource{ opacity: 0.4; filter: saturate(.8); }

/* ë“œë˜ê·¸ í”„ë¦¬ë·° */
.dragLayer .dragCardPreview{
  overflow: hidden;
  border-radius: 0;
  background: transparent !important;
  clip-path: inset(0);
  isolation: isolate;
}
.dragLayer .dragCardPreview *{
  background: transparent !important;
  filter: none !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  mix-blend-mode: normal !important;
}

/* í‚¤ì›Œë“œ ë¸”ë¡ */
.kwRun, .kwBadge{
  display: inline-flex;
  align-items: baseline;
  gap: calc(2 * var(--u));
  white-space: nowrap;
}
.kwRun *, .kwBadge *{ white-space: nowrap; }

/* ìŠ¬ë¡¯ ì´ë¦„ë§Œ ë³´ì´ëŠ” ì¹´ë“œ */
.card.slotNameOnly{
  height: 100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: calc(6 * var(--u) * var(--boardScale));
  text-align: center;

  overflow: hidden;
  border-radius: 0;
  clip-path: inset(0);
}
.card.slotNameOnly .cardTitle{
  font-size: calc(10 * var(--u) * var(--boardScale));
  font-weight: 900 !important;

  width: 100%;
  box-sizing: border-box;
  padding: 0 0.35em;

  white-space: normal;
  overflow-wrap: anywhere;
  word-break: break-word;
  line-height: 1.1;

  display: -webkit-box;
  -webkit-box-orient: vertical;
  line-clamp: 2;
  -webkit-line-clamp: 2;
  overflow: hidden;
}
.card.slotNameOnly .cardBody{ display:none !important; }

/* ì¹´ë“œ í˜¸ë²„ ìƒì„¸ í”„ë¦¬ë·°(ìš°ì¸¡) */
.cardHoverPreview{
  position: fixed;
  right: calc(var(--edgePad) + calc(14 * var(--u)));
  top: calc(var(--hudH) + calc(110 * var(--u)));
  z-index: var(--zChrome);
  width: calc(360 * var(--u));
  height: auto;

  border-radius: 0;
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.78);
  backdrop-filter: blur(calc(10 * var(--u)));
  -webkit-backdrop-filter: blur(calc(10 * var(--u)));
  box-shadow: 0 calc(18 * var(--u)) calc(60 * var(--u)) rgba(0,0,0,.55);

  padding: calc(14 * var(--u));
  display: none;
  pointer-events: none;
}
.cardHoverPreview.on{ display:block; }

.cardHoverPreviewTitle{
  font-weight: 900;
  font-size: calc(18 * var(--u));
  margin-bottom: calc(10 * var(--u));
  opacity: .95;
}
.cardHoverPreviewRow{
  display: grid;
  grid-template-columns: 1fr;
  gap: calc(12 * var(--u));
  align-items: start;
}
.cardHoverPreviewCard{
  width: calc(220 * var(--u));
  margin: 0 auto;
  transform: translateY(calc(4 * var(--u)));
}
.cardHoverPreviewDetail{
  border-radius: 0;
  border: calc(1 * var(--u)) solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.03);
  padding: calc(12 * var(--u));
  white-space: pre-wrap;
  line-height: 1.4;
  font-size: calc(13 * var(--u));
}


/* =========================
   9-1) HARD OVERRIDE â€” NO ROUNDING ANYWHERE
   - ì¹´ë“œ/ìŠ¬ë¡¯ ê´€ë ¨ ì˜ì—­ ëª¨ì„œë¦¬ ì „ë¶€ ê°ì§€ê²Œ
   ========================= */
.slot,
.slot::before,
.slotCardScaler,
.slotCardInner,
.card,
.card::before,
.card.selected,
.card.slotNameOnly,
.dragLayer .dragCardPreview,
.cardHoverPreview,
.cardHoverPreviewDetail{
  border-radius: 0 !important;
}
.card.slotNameOnly,
.dragLayer .dragCardPreview{
  clip-path: inset(0) !important;
}


/* =========================
   10) HAND DOCK
   - ì†íŒ¨ ë„í¬(í•˜ë‹¨) + ê°€ë¡œ ìŠ¤í¬ë¡¤
   ========================= */
.handDock{
  position: fixed;
  left: 50%;
  width: min(calc(780 * var(--u)), calc(100vw - var(--safeL) - var(--safeR)));
  max-width: calc(100vw - var(--safeL) - var(--safeR));
  transform: translateX(-50%);
  bottom: var(--safeB);
  height: var(--dockH);
  padding: calc(6 * var(--u)) var(--edgePad) calc(10 * var(--u)) var(--edgePad);
  background: linear-gradient(
    to top,
    rgba(0,0,0,0.92) 0%,
    rgba(0,0,0,0.65) 35%,
    rgba(0,0,0,0.00) 100%
  );

  z-index: var(--zHandDock);
  pointer-events: none;
}
.handDock * { pointer-events: auto; }

.handDock > .controlsDock,
.handDock > .hand{
  transform: none !important;
}

.hand{
  height: calc(var(--handCardH) + calc(12 * var(--u)));
  position: relative;
  box-sizing: border-box;
  padding-inline: calc(22 * var(--u));
  scroll-padding-left: calc(22 * var(--u));
  scroll-padding-right: calc(22 * var(--u));

  overflow-x: auto;
  overflow-y: visible;
  -webkit-overflow-scrolling: touch;

  /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€(ìŠ¤í¬ë¡¤ì€ ìœ ì§€) */
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.hand::-webkit-scrollbar{ width: 0; height: 0; }
.hand::-webkit-scrollbar-thumb{ background: transparent; }
.hand::-webkit-scrollbar-track{ background: transparent; }

/* hand edge fades (cutì´ ë…¸ê³¨ì ìœ¼ë¡œ ë³´ì´ëŠ” ê²ƒ ì™„í™”) */
.hand::before,
.hand::after{
  content: "";
  position: absolute;
  top: 0;
  bottom: 0;
  width: calc(28 * var(--u));
  pointer-events: none;
  z-index: 5;
}
/*.hand::before{
  left: 0;
  background: linear-gradient(90deg, rgba(0,0,0,.70), rgba(0,0,0,0));
}
.hand::after{
  right: 0;
  background: linear-gradient(-90deg, rgba(0,0,0,.70), rgba(0,0,0,0));
}*/


.handCardsRow{
  display: flex;
  justify-content: center;
  flex-wrap: nowrap;
  gap: calc(10 * var(--u));
  align-items: flex-end;
  width: max-content;
  min-width: 100%;
  padding: calc(6 * var(--u)) 0 0 0;
  overflow: visible !important;
}


/* =========================
   11) LOG PANEL + OVERLAY
   - ìš°ì¸¡ ë¡œê·¸ íŒ¨ë„ + ì˜¤ë²„ë ˆì´ ë ˆì´ì–´
   ========================= */
.logPanel{
  position: fixed;
  top: calc(var(--safeT) + var(--hudH) + calc(8 * var(--u)));
  right: var(--edgePad);
  width: var(--logW);
  height: min(46vh, calc(420 * var(--u)));
  padding: calc(14 * var(--u));
  display:flex;
  flex-direction:column;
  box-sizing: border-box;
  isolation: isolate;

  background: var(--logBg);
  border: calc(1 * var(--u)) solid var(--logLine);
  box-shadow: var(--logShadow);
  border-radius: calc(18 * var(--u));
  z-index: var(--zChrome);
}

.logPanel .log{
  flex:1;
  min-height:0;
  margin:0;
  padding: calc(10 * var(--u));
  border-radius: calc(12 * var(--u));
  border:calc(1 * var(--u)) solid var(--line);
  background: rgba(0,0,0,.55);
  color: #cfd5e2;
  font-size: calc(12 * var(--u));
  line-height: 1.45;
  overflow:auto;
  white-space: pre-wrap;
}

/* ì ‘í˜ ìƒíƒœ: ë²„íŠ¼ë§Œ */
.logPanel.collapsed{
  width: calc(56 * var(--u));
  height: calc(56 * var(--u));
  padding: calc(10 * var(--u));
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}
.logPanel.collapsed .log{ display:none; }
.logPanel.collapsed:hover{ opacity: .85; }
.logPanel.collapsed::before,
.logPanel.collapsed::after{ content:none !important; display:none !important; }

.logPanel.collapsed .logHeaderRow{
  background: rgba(0,0,0,.92) !important;
  border: calc(1 * var(--u)) solid rgba(255,255,255,.22) !important;
  box-shadow: 0 calc(10 * var(--u)) calc(24 * var(--u)) rgba(0,0,0,.55) !important;
}

.logHeaderRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: calc(8 * var(--u));
  -webkit-user-select: none;
  user-select:none;
  cursor:pointer;
  padding: calc(8 * var(--u)) calc(10 * var(--u));
  border-radius: calc(12 * var(--u));
  border: calc(1 * var(--u)) solid var(--line);
  background: rgba(0,0,0,1);
  margin-bottom: calc(10 * var(--u));
}
.logHeaderRow h2{ margin:0; font-size: calc(14 * var(--u)); }
.logHeaderRow .chev{ opacity:.85; font-size: calc(14 * var(--u)); }

.logOverlay,
.logOverlayLayer{
  position: fixed;
  inset: 0;
  z-index: var(--zLogOverlay) !important;
  pointer-events: auto !important;
}

/* ë¡œê·¸ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
.logScroll{
  scrollbar-width: none;
  scrollbar-color: transparent transparent;
}
.logScroll::-webkit-scrollbar{ width: 0; height: 0; }
.logScroll::-webkit-scrollbar-thumb{ background: transparent; }
.logScroll::-webkit-scrollbar-track{ background: transparent; }


/* =========================
   12) NODE PREVIEW
   - ë…¸ë“œ í”„ë¦¬ë·° ë¼ì¸(ì•„ì´ì½˜/í…ìŠ¤íŠ¸)
   ========================= */
.nodeIcon{
  display:inline-block;
  width:1.25em;
  text-align:center;
  line-height:1;
  vertical-align:middle;
  font-family:"Mulmaru","Segoe UI Symbol","Noto Sans Symbols 2","Noto Sans Symbols",sans-serif;
  font-variant-emoji:text;
}
.nodeText{ margin-left:.15em; vertical-align:middle; }
.nodeSep{ margin: 0 .25em; opacity: .8; }

.nodePreviewRow{
  display: grid;
  grid-template-columns: var(--colNow) var(--colArrow) var(--colNext) var(--colSlash) var(--colNext);
  column-gap: var(--gap);
  align-items: center;

  padding: calc(10 * var(--u));
  border-radius: calc(14 * var(--u));
  cursor: pointer;
}
.nodeCol{ min-width: 0; }
.nodeSepArrow,
.nodeSepSlash{
  text-align: center;
  opacity: .9;
  -webkit-user-select: none;
  user-select: none;
  pointer-events: none;
}


/* =========================
   13) ENEMY HUD CENTER
   - ì¤‘ì•™ ìƒë‹¨ ì  HUD(ë°°ë„ˆí˜•)
   ========================= */
.enemyHudCenter{
  position: fixed;
  top: calc(8 * var(--u));
  left: 50%;
  transform: translateX(calc(-50% + var(--enemyHudDx)));

  width: auto;
  max-width: calc(100vw - calc(24 * var(--u)));
  height: auto;

  background: none !important;
  border: 0 !important;
  box-shadow: none !important;
  padding: 0 !important;
  margin: 0 !important;

  z-index: var(--zChrome) !important;
  pointer-events: auto !important;
}
.enemyHudCenter *{ pointer-events: auto !important; }

.enemyHudCenter .enemyHudCenterMover,
.enemyHudCenter .enemyHud,
.enemyHudCenter .enemyStrip{
  display:flex;
  flex-direction: row;
  gap: calc(12 * var(--u));
  align-items: stretch;
  justify-content: center;
  flex-wrap: nowrap;
  background: none !important;
  pointer-events: auto;
}

/* í´ë¦­ ê°€ëŠ¥í•œ ì  ë°°ë„ˆ/ì¹© */
.enemyHudCenter .enemyChip,
.enemyHudCenter .enemyBanner{
  flex: 0 0 var(--enemyHudW) !important;
  width: var(--enemyHudW) !important;
  max-width: var(--enemyHudW) !important;

  pointer-events: auto !important;
  cursor: pointer;

  border-radius: calc(18 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.68);
  box-shadow: 0 calc(18 * var(--u)) calc(50 * var(--u)) rgba(0,0,0,.35);
  overflow: hidden;
  box-sizing: border-box;
}

.enemyHudCenter .enemyChipTop,
.enemyHudCenter .enemyIntent{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.enemyChipTop{
  display: flex;
  flex-direction: row;
  align-items: baseline;
  justify-content: space-between;
  gap: calc(8 * var(--u));
  white-space: nowrap;
}

.enemyHudCenter{
  min-height: 0 !important;
  height: auto !important;
}


/* =========================
   14) HP PIXEL BARS
   - ì  ì²´ë ¥ë°” í”½ì…€ ëŠë‚Œ
   ========================= */
.enemyHPOuter{
  height: var(--hpH) !important;
  border-radius: calc(2 * var(--u)) !important;
  overflow: hidden !important;
  background: rgba(0,0,0,.35) !important;
  border: calc(1 * var(--u)) solid var(--hpBorder) !important;
  box-shadow:
    inset 0 calc(1 * var(--u)) 0 var(--hpFrame),
    inset 0 -calc(1 * var(--u)) 0 rgba(0,0,0,.55);
  image-rendering: pixelated;
}
.enemyHPFill{
  height: 100% !important;
  border-radius: 0 !important;
  transition: none !important;
  background-image:
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,.18) 0,
      rgba(255,255,255,.18) calc(1 * var(--u)),
      rgba(0,0,0,0) calc(1 * var(--u)),
      rgba(0,0,0,0) var(--hpSeg)
    ),
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(0,0,0,.20));
  background-size: auto 100%, 100% 100%;
  background-blend-mode: overlay;
  background-color: #7f241d !important;
}


/* =========================
   15) FX / MISC HUD
   - ì „íˆ¬ ì»¨íŠ¸ë¡¤/í˜ì´ì¦ˆ ë°°ë„ˆ/ìƒë‹¨ ì½”ë„ˆ HUD/S HUD/íŒíŠ¸/í”Œë¡œíŒ… ìˆ«ì
   ========================= */

/* ì „íˆ¬ ì»¨íŠ¸ë¡¤(ë‹¤ìŒ í„´ ë²„íŠ¼) */
.combatControls{
  position: absolute;
  justify-content: center;
  left: 100rem;
  top: 40rem;
  transform: translate(450%, calc(90% - var(--combatCtrlLift)));
  z-index: 1000;
  pointer-events: auto;

  /* ê¸°ì¡´ ìœ„ì¹˜ ê°•ì œ ë¬´íš¨í™” */
  bottom: auto !important;
  right: auto !important;
}
.combatControls *{ pointer-events: auto !important; }

.combatControls .stepBtn{
  padding: calc(10 * var(--u)) calc(14 * var(--u));
  border-radius: calc(6 * var(--u));
  font-size: calc(20 * var(--u));
  line-height: 1.1;
}
.combatControls .stepBtn.primary{ font-weight: 600; }

/* í˜ì´ì¦ˆ ë°°ë„ˆ */
.phaseBanner{
  position: fixed;
  left: 50%;
  top: calc(64 * var(--u));
  transform: translateX(-50%);
  padding: calc(10 * var(--u)) calc(14 * var(--u));
  border-radius: calc(14 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.18);
  background: rgba(0,0,0,.80);
  color: #fff;
  font-weight: 900;
  letter-spacing: calc(2 * var(--u));
  -webkit-backdrop-filter: blur(calc(6 * var(--u)));
  backdrop-filter: blur(calc(6 * var(--u)));
  pointer-events: none;
  animation-name: phaseInOut;
  animation-duration: calc(420ms * var(--animMul));
  animation-timing-function: ease;
  animation-fill-mode: both;
}
@keyframes phaseInOut{
  0%   { opacity: 0; transform: translateX(-50%) translateY(calc(-6 * var(--u))); }
  20%  { opacity: 1; }
  70%  { opacity: 1; }
  100% { opacity: 0; transform: translateX(-50%) translateY(calc(-12 * var(--u))); }
}

/* ìŠ¤í…Œì´ì§€ ì½”ë„ˆ HUD(ìƒë‹¨ ì¢Œì¸¡ ê·¼ì²˜ ê³ ì •) */
.stageCornerHud{
  position: fixed;
  pointer-events: none;

  left: calc(var(--safeL) + calc(160 * var(--u))) !important;
  right: auto !important;

  text-align: left;
  white-space: nowrap;

  padding: calc(17 * var(--u)) calc(10 * var(--u));
  background: rgba(0, 0, 0, 1);
  border: calc(1 * var(--u)) solid rgba(255,255,255,.18);
  border-radius: calc(10 * var(--u));
  box-shadow:
    0 calc(2 * var(--u)) 0 rgba(0,0,0,.55),
    inset 0 calc(1 * var(--u)) 0 rgba(255,255,255,.10),
    inset 0 -calc(1 * var(--u)) 0 rgba(0,0,0,.45);

  color: rgba(235,240,255,.96);
  font-size: calc(18 * var(--u));
  line-height: 1.5;
  text-shadow:
    calc(2 * var(--u)) calc(2 * var(--u)) 0 rgba(0,0,0,.90),
    -calc(2 * var(--u)) calc(2 * var(--u)) 0 rgba(0,0,0,.90),
    calc(2 * var(--u)) -calc(2 * var(--u)) 0 rgba(0,0,0,.90),
    -calc(2 * var(--u)) -calc(2 * var(--u)) 0 rgba(0,0,0,.90);

  top:  calc(var(--safeT) + calc(10 * var(--u)));
  transform: translateX(-50%) translateY(570%) translateY(var(--stageCornerLiftY)) !important;
  z-index: var(--zChrome);
}

/* S ì „ìš© HUD */
#hudSOnly{
  position: fixed;
  left: var(--sHudLeft);
  top:  var(--sHudTop);
  transform: translate(var(--sHudOffX), var(--sHudOffY));
  z-index: var(--zChrome);

  padding: var(--sHudPadY) var(--sHudPadX);
  background: rgb(255, 255, 255);
  border: calc(1 * var(--u)) solid rgba(255,255,255,0);
  border-radius: var(--sHudR);

  font-weight: 900;
  font-size: var(--sHudFont);
  color: rgb(0, 0, 0);
  line-height: 1;
  white-space: nowrap;

  pointer-events: none;
}

/* ìƒˆ ëŸ° ì‹œì‘ ë²„íŠ¼(ì¢Œìƒë‹¨) */
.floatingNewRun,
.newRunBtn{
  position: fixed;
  top:  calc(var(--safeT) + calc(8 * var(--u)));
  left: calc(var(--safeL) + calc(10 * var(--u)));
  z-index: calc(var(--zChrome) + 10000);
  pointer-events: auto;
}
.newRunBtn *{ pointer-events:auto !important; }

/* ìƒˆ ëŸ° ë²„íŠ¼ ì˜† ì‹ ì•™ ë°°ì§€ */
.floatingFaithBadge{
  position: fixed;
  z-index: calc(var(--zChrome) + 10000);
  pointer-events: auto;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  padding: calc(8 * var(--u)) calc(10 * var(--u));
  border-radius: calc(999 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.18);
  background: rgba(0,0,0,1);
  color: rgba(255,255,255,.92);

  font-size: calc(13 * var(--u));
  line-height: 1;
  white-space: nowrap;

  font-family: "Mulmaru", ui-sans-serif, system-ui, -apple-system,
               "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif !important;
}

/* íƒ€ê²Ÿ íŒíŠ¸(HUD ê·¼ì²˜) */
.targetHintInline{
  position: fixed;
  left: 50%;
  top: var(--targetHintTop) !important;
  transform: translateX(-50%);
  pointer-events: none;

  max-width: min(calc(720 * var(--u)), calc(100vw - calc(24 * var(--u))));
  padding: calc(6 * var(--u)) calc(10 * var(--u));
  border-radius: calc(12 * var(--u));

  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* í”Œë¡œíŒ… ìˆ«ì FX */
.floatFxLayer{
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: var(--zChrome);
}

.floatNum{
  position: absolute;
  transform: translate(-50%, -50%);
  font-weight: 900;
  font-size: calc(18 * var(--u));
  text-shadow: 0 calc(2 * var(--u)) 0 rgba(0,0,0,.55), 0 0 calc(12 * var(--u)) rgba(0,0,0,.45);
  animation-name: floatUp;
  animation-duration: calc(650ms * var(--animMul));
  animation-timing-function: ease-out;
  animation-fill-mode: both;
  will-change: transform, opacity;
}
.floatNum.dmg{  color: #ff6b6b; }
.floatNum.heal{ color: #6bff9e; }
.floatNum.block{ color:#8cc7ff; }

@keyframes floatUp{
  0%   { opacity: 0; transform: translate(-50%, -50%) translateY(calc(8 * var(--u))) scale(.96); }
  15%  { opacity: 1; }
  100% { opacity: 0; transform: translate(-50%, -50%) translateY(-calc(22 * var(--u))) scale(1.05); }
}


/* =========================
   16) SETTINGS / RULEBOOK OVERLAYS
   - ì„¤ì •/ë£°ë¶ ë“± ì „ì²´ ì˜¤ë²„ë ˆì´ ë ˆì´ì•„ì›ƒ
   ========================= */
.overlay-layer{
  position: fixed !important;
  inset: 0 !important;
  z-index: var(--zRulebook) !important;
  pointer-events: auto !important;
}
.overlay-panel{
  z-index: calc(var(--zRulebook) + 1) !important;
  pointer-events: auto !important;
}

.settingsOverlay{
  position: fixed;
  inset: 0;
  z-index: var(--zSettings) !important;

  background: rgba(0,0,0,0.92);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: calc(24 * var(--u));
  box-sizing: border-box;

  pointer-events: auto !important;
}
.settingsOverlay *{ pointer-events:auto !important; }

.settingsPanel{
  width: min(calc(760 * var(--u)), 90%) !important;
  max-width: none !important;
  max-height: none !important;
  overflow: visible;

  border-radius: calc(18 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  background: rgba(10,12,14,1);
  padding: calc(16 * var(--u));
}


/* =========================
   17) CHOICE / EVENT OVERLAY
   - ì´ë²¤íŠ¸/ì„ íƒ ëª¨ë‹¬ íŒ¨ë„ + ë¦¬ìŠ¤íŠ¸ ìŠ¤í¬ë¡¤
   ========================= */
.choice-contentRow{
  display:flex;
  gap: var(--choiceRowGap);
  margin-top: calc(12 * var(--u));
  justify-content:center;
  align-items:stretch;

  flex: 1 1 auto;
  min-height: 0;
}

.choice-leftCol{
  flex: 1 1 calc(640 * var(--u));
  max-width: calc(720 * var(--u));
  min-width: 0;

  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  min-height: 0;
}

.choice-illuCol{
  flex: 0 0 var(--choiceIlluSize);
  min-width: var(--choiceIlluMin);
  display:flex;
  align-items:center;
  justify-content:center;
}

.choice-illuBox{
  width: 100%;
  aspect-ratio: 1 / 1;
  border-radius: calc(18 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.16);
  background: rgba(0,0,0,.35);
  overflow: hidden;
  position: relative;
}

.choice-list{
  display:flex;
  flex-direction:column;
  gap: var(--choiceListGap);

  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;
  padding-right: calc(6 * var(--u));
}

.choice-item{
  display:flex;
  gap: calc(12 * var(--u));
  align-items:flex-start;
  border:calc(1 * var(--u)) solid rgba(255,255,255,.10);
  border-radius: calc(14 * var(--u));
  padding: calc(12 * var(--u));
  background: rgba(255,255,255,.03);
  position:relative;
}

pre.choice-detail,
.choice-panel pre.choice-detail{
  font-family: "Mulmaru", sans-serif !important;
  font-size: calc(13 * var(--u));
  line-height: 1.35;
  letter-spacing: -calc(0.2 * var(--u));
}

.choice-overlay{
  position: fixed;
  inset: 0;
  z-index: var(--zChoiceBackdrop) !important;
  pointer-events: auto !important;

  /* Faith selection should black out the screen (no transparency) */
  background: rgba(0,0,0,0) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;

  display:flex;
  justify-content:center;
  align-items:flex-start;
  box-sizing:border-box;
}

/* ë°°ê²½ ì œê±°(ì™„ì „ íˆ¬ëª…) */
.choice-backdrop{
  pointer-events: auto !important;
  background: rgba(0, 0, 0, 0) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* ëª¨ë‹¬ íŒ¨ë„(ì¤‘ì•™ ê³ ì • + Dx/Dy ë³´ì •) */
.choice-panel{
  position: fixed !important;
  z-index: var(--zChoicePanel) !important;
  pointer-events: auto !important;

  display: flex;
  flex-direction: column;

  left: 50% !important;
  top: 50% !important;

  transform:
    translate(-50%, -50%)
    translate(
      calc(var(--choicePanelDx) * var(--u)),
      calc(var(--choicePanelDy) * var(--u))
    ) !important;

  width: min(calc(800 * var(--u)), 96vw);
  max-height: calc(92vh - calc(var(--choicePanelMarginY) * var(--u)) * 2);
  padding: var(--choicePanelPad);
  box-sizing: border-box;
  overflow: auto;
  overflow-x: hidden;
  border: calc(1 * var(--u)) solid rgba(255,255,255,0.1);
  border-radius: var(--choicePanelR);
  background: rgba(0,0,0,1);
  box-shadow: 0 calc(18 * var(--u)) calc(60 * var(--u)) rgba(0,0,0,1);

  /* Ensure Mulmaru inside choice panels (esp. Faith) */
  font-family: "Mulmaru", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}


/* =========================
   18) TRAYS (ITEMS + RELICS)
   - ì•„ì´í…œ íŠ¸ë ˆì´ / ë ë¦­ íŠ¸ë ˆì´ ê³µí†µ ë ˆì´ì•„ì›ƒ
   ========================= */

/* ì•„ì´í…œ ìŠ¬ë¡¯ ê¸°ë³¸ ìŠ¤íƒ€ì¼(íŠ¸ë ˆì´ ë°–ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥) */
.itemSlot{
  width: calc(60 * var(--u));
  height: calc(60 * var(--u));
  border-radius: calc(14 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.18);
  background: rgba(0,0,0,.35);
  box-shadow: 0 calc(8 * var(--u)) calc(20 * var(--u)) rgba(0,0,0,.35);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  overflow: hidden;
}
.itemSlot img{
  width: 86%;
  height: 86%;
  object-fit: contain;
  image-rendering: pixelated;
}
.itemSlot:hover{ background: rgba(255,255,255,.06); }
.itemSlot:active{ transform: translateY(calc(1 * var(--u))); }
.itemSlot.disabled{ opacity: .45; cursor: default; }

/* ì•„ì´í…œ: ë²„ë¦¬ê¸° ë²„íŠ¼(í˜¸ë²„ ì‹œ í‘œì‹œ) */
.itemDropBtn{
  position: absolute;
  top: calc(2 * var(--u));
  right: calc(2 * var(--u));
  width: calc(18 * var(--u));
  height: calc(18 * var(--u));
  border-radius: calc(6 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.22);
  background: rgba(0,0,0,.55);
  color: rgba(255,255,255,.85);
  font-size: calc(12 * var(--u));
  line-height: 1;
  display: grid;
  place-items: center;
  cursor: pointer;
  opacity: 0;
  transform: translateY(calc(-1 * var(--u)));
  transition: opacity .12s ease, transform .12s ease, background .12s ease;
  z-index: 2;
}
.itemSlot:hover .itemDropBtn{
  opacity: 1;
  transform: translateY(0);
}
.itemDropBtn:hover{ background: rgba(0,0,0,.78); }
.itemDropBtn:active{ transform: translateY(calc(1 * var(--u))); }

/* ì•„ì´í…œ íŠ¸ë ˆì´: ìˆ˜ëŸ‰/í•œë„ ë°°ì§€ */
.itemCapBadge{
  position: absolute;
  left: calc(6 * var(--u));
  top: calc(6 * var(--u));
  padding: calc(3 * var(--u)) calc(6 * var(--u));
  border-radius: calc(999 * var(--u));
  background: rgba(0,0,0,.55);
  border: calc(1 * var(--u)) solid rgba(255,255,255,.18);
  font-size: calc(11 * var(--u));
  color: rgba(255,255,255,.85);
  pointer-events: none;
  z-index: 2;
}

/* ì•„ì´í…œ íŠ¸ë ˆì´: ë°°ì§€ + íŒíŠ¸(4/4 ì˜†, íŠ¸ë ˆì´ë³´ë‹¤ ì‚´ì§ ìœ„) */
.itemCapHud{
  position: fixed;
  display: flex;
  align-items: center;
  gap: calc(6 * var(--u));
  pointer-events: none;
  z-index: calc(var(--zRelicHud) + 2);
}
.itemCapHud .itemCapBadge{
  position: static;
  left: auto;
  top: auto;
}
.itemCapHint{
  padding: calc(3 * var(--u)) calc(7 * var(--u));
  border-radius: calc(999 * var(--u));
  background: rgba(0,0,0,.42);
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  font-size: calc(11 * var(--u));
  color: rgba(255,255,255,.78);
  white-space: nowrap;
}

/* ì•„ì´ì½˜ ë¶€ëª¨ ë°•ìŠ¤ëŠ” í•­ìƒ ì˜ë¼ë‚´ê¸° */
#itemTray .itemSlot,
#itemTray .itemCell,
.itemSlot,
.itemCard,
.shopItemCard,
.shopItemIconWrap{
  overflow: hidden !important;
  position: relative;
}

/* ì•„ì´í…œ íŠ¸ë ˆì´(ì¢Œí•˜ë‹¨ ê³ ì •) */
:is(#itemTray, .itemTray){
  position: fixed !important;
  left: var(--itemTrayLeft) !important;
  bottom: var(--trayBottom) !important;
  z-index: var(--zRelicHud) !important;
  pointer-events: auto !important;

  display: grid !important;
  grid-template-columns: repeat(var(--trayCols), var(--traySlot)) !important;
  grid-auto-rows: var(--traySlot) !important;
  gap: var(--trayGap) !important;

  box-sizing: border-box !important;
  max-height: calc(
    (var(--traySlot) * var(--trayRowsMax))
    + (var(--trayGap) * (var(--trayRowsMax) - 1))
    + (var(--trayPad) * 2)
  ) !important;

  max-width: calc(
    (var(--traySlot) * var(--trayCols))
    + (var(--trayGap) * (var(--trayCols) - 1))
    + (var(--trayPad) * 2)
  ) !important;

  padding: var(--trayPad) !important;

  overflow-y: auto !important;
  overflow-x: hidden !important;
  align-content: start !important;

  /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€(ìŠ¤í¬ë¡¤ì€ ìœ ì§€) */
  scrollbar-width: none;
  -ms-overflow-style: none;
}
:is(#itemTray, .itemTray)::-webkit-scrollbar{ width: 0; height: 0; }
:is(#itemTray, .itemTray)::-webkit-scrollbar-thumb{ background: transparent; }
:is(#itemTray, .itemTray)::-webkit-scrollbar-track{ background: transparent; }

/* íŠ¸ë ˆì´ ì…€(ì•„ì´í…œ ì¹´ë“œ/ì…€ ê³µí†µ) */
:is(#itemTray, .itemTray) :is(.itemSlot, .itemCell, .itemCard){
  width:  var(--traySlot) !important;
  height: var(--traySlot) !important;
  box-sizing: border-box !important;

  border: calc(1 * var(--u)) solid rgba(255,255,255,.18) !important;
  background: rgba(0,0,0,0.35) !important;

  border-radius: calc(14 * var(--u)) !important;
  box-shadow: 0 calc(8 * var(--u)) calc(20 * var(--u)) rgba(0,0,0,.35) !important;

  display: grid !important;
  place-items: center !important;
  cursor: pointer;
  overflow: hidden !important;
}

/* íŠ¸ë ˆì´ ì•„ì´ì½˜ ì´ë¯¸ì§€ í• */
:is(#itemTray, .itemTray) :is(.itemSlot, .itemCell, .itemCard) img{
  width: 86% !important;
  height: 86% !important;
  object-fit: contain !important;
  image-rendering: pixelated !important;
}

/* ì•„ì´ì½˜ í™•ëŒ€(ì•„ì´í…œ/ìƒì /ê¸°íƒ€ ê³µìš©) */
#itemTray img,
.itemSlot img,
.itemCard img,
.shopItemCard img,
.shopItemIconWrap img{
  transform: scale(1.8);
  transform-origin: center;
  display: block;
}

/* íŠ¸ë ˆì´ ë‚´ë¶€ì— ë¶™ëŠ” íˆ´íŒì€ ì™„ì „íˆ ì œê±°(ì»¤ì„œ í˜¸ë²„ë¡œë§Œ í‘œì‹œë˜ëŠ” íˆ´íŒë§Œ ìœ ì§€) */
:is(#itemTray, .itemTray) .itemHoverTip{
  display: none !important;
}



/* =========================
   18-1) RELICS
   - ìš°í•˜ë‹¨ ë ë¦­ íŠ¸ë ˆì´ + íˆ´íŒ/ëª¨ë‹¬
   ========================= */
.relicTray{
  position: fixed;
  right: var(--relicTrayRight) !important;
  bottom: var(--trayBottom) !important;
  z-index: var(--zRelicHud);
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: calc(8 * var(--u));
  pointer-events: auto;


}

/* ë ë¦­ ë¦¬ìŠ¤íŠ¸(4ì—´ 3í–‰ ê¸°ì¤€, ê·¸ ì´ìƒì€ ìŠ¤í¬ë¡¤) */
.relicTrayList{
  display: grid;
  grid-template-columns: repeat(var(--trayCols), var(--traySlot)) !important;
  grid-auto-rows: var(--traySlot) !important;
  gap: var(--trayGap) !important;

  justify-content: end;
  justify-items: stretch;
  align-items: stretch;

  box-sizing: border-box !important;
  max-height: calc(
    (var(--traySlot) * var(--trayRowsMax))
    + (var(--trayGap) * (var(--trayRowsMax) - 1))
    + (var(--trayPad) * 2)
  ) !important;

  max-width: calc(
    (var(--traySlot) * var(--trayCols))
    + (var(--trayGap) * (var(--trayCols) - 1))
    + (var(--trayPad) * 2)
  ) !important;

  overflow-y: auto;
  overflow-x: hidden;

  padding: var(--trayPad) !important;

  scrollbar-gutter: stable;
  scroll-snap-type: y mandatory;

  /* ì•„ë˜ì—ì„œ ìœ„ë¡œ ìŒ“ì´ëŠ” ëŠë‚Œ(ìŠ¤í¬ë¡¤ ë°©í–¥ ë°˜ì „) */
  transform: rotate(180deg);
}

/* ì•„ì´ì½˜ì€ ë‹¤ì‹œ ë’¤ì§‘ì–´ì„œ ì •ìƒ í‘œì‹œ */
.relicTrayList .relicIcon{ transform: rotate(180deg); }

.relicIcon, .relicHoverTip, .relicModalPanel{ direction: ltr; }

/* ë ë¦­ ìŠ¤í¬ë¡¤ë°”(ë³´ì´ëŠ” ë²„ì „) */
.relicTrayList::-webkit-scrollbar{ width: calc(10 * var(--u)); }
.relicTrayList::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.18);
  border-radius: calc(999 * var(--u));
}
.relicTrayList::-webkit-scrollbar-track{
  background: rgba(0,0,0,0.18);
  border-radius: calc(999 * var(--u));
}

.relicIcon{
  width: var(--relicIconSize);
  height: var(--relicIconSize);
  border-radius: calc(14 * var(--u));

  border: calc(2 * var(--u)) solid rgba(255, 255, 255, 1);
  background: rgba(0, 0, 0, 0.35);
  color: rgba(255, 255, 255, 0.92);

  display: grid;
  place-items: center;
  cursor: pointer;

  overflow: hidden;
  scroll-snap-align: start;

  box-sizing: border-box;
}

.relicIconImg{
  width: 100%;
  height: 100%;
  display: block;

  object-fit: cover;
  object-position: center;
  transform: scale(var(--relicImgZoom));
  transform-origin: center;

  image-rendering: pixelated;
}

.relicHoverTip{
  display: none;
  min-width: calc(220 * var(--u));
  max-width: calc(360 * var(--u));
  background: rgba(0, 0, 0, 0.82);
  border: calc(1 * var(--u)) solid rgba(255, 255, 255, 0.12);
  border-radius: calc(14 * var(--u));
  padding: calc(10 * var(--u)) calc(12 * var(--u));
  color: rgba(255, 255, 255, 0.92);
  box-shadow: 0 calc(18 * var(--u)) calc(40 * var(--u)) rgba(0, 0, 0, 0.45);
}
.relicTipTitle{ font-weight: 700; margin-bottom: calc(6 * var(--u)); }
.relicTipBody{ font-size: calc(12.5 * var(--u)); line-height: 1.35; white-space: pre-wrap; }

.relicModal{
  position: fixed;
  inset: 0;
  z-index: var(--zRelicModal);
  background: rgba(0, 0, 0, 0.55);
  display: grid;
  place-items: center;
  padding: calc(18 * var(--u));
}

.relicModalPanel{
  width: min(calc(720 * var(--u)), 96vw);
  max-height: min(84vh, calc(900 * var(--u)));
  overflow: auto;
  background: rgba(18, 18, 18, 0.96);
  border: calc(1 * var(--u)) solid rgba(255, 255, 255, 0.14);
  border-radius: calc(16 * var(--u));
  box-shadow: 0 calc(20 * var(--u)) calc(60 * var(--u)) rgba(0, 0, 0, 0.55);
  transform: translateY(-calc(60 * var(--u)));
}

.relicModalHeader{
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: calc(14 * var(--u)) calc(16 * var(--u));
  border-bottom: calc(1 * var(--u)) solid rgba(255, 255, 255, 0.10);
}
.relicModalTitle{ font-weight: 800; }

.relicModalBody{
  padding: calc(16 * var(--u));
  display: grid;
  grid-template-columns: calc(160 * var(--u)) 1fr;
  gap: calc(16 * var(--u));
  align-items: start;
}

.relicModalArt{
  width: calc(160 * var(--u));
  height: calc(160 * var(--u));
  border-radius: calc(14 * var(--u));
  overflow: hidden;
  border: calc(1 * var(--u)) solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.28);
}
.relicModalArtImg{
  width: 100%;
  height: 100%;
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  transform: scale(1.15);
  transform-origin: center;
  image-rendering: pixelated;
}
.relicModalArtImg:empty{ background-image: none; }

.relicModalText{
  white-space: pre-wrap;
  line-height: 1.45;
}


/* =========================
   19) ENEMY CARDS
   - ì  ì¹´ë“œ í”„ë ˆì„/ì•„íŠ¸/ë¯¸ë‹ˆ HUD + í˜¸ë²„ ìƒì„¸
   ========================= */
.enemyBanner.enemyCardWrap{
  position: relative;
  flex: 0 0 auto;
  padding: 0;
  border: none;
  background: transparent;

  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: visible !important;

  --enemyUi: 0.95;
}

.enemyArtWrap{
  position: relative;
  width: 100%;
  display: flex;
  justify-content: center;
  overflow: visible;
  --artZoom: 1;
}

/* í”„ë ˆì„ PNG ë¹„ìœ¨(1365x2048)ì— ë§ì¶˜ ë°•ìŠ¤ */
.enemyArtCard{
  position: relative;
  width: calc(70% * var(--enemyUi));
  margin: calc(8 * var(--u)) auto 0;
  aspect-ratio: 1365 / 2048;
  height: auto;
  flex: 0 0 auto;

  border-radius: calc(2 * var(--u));
  overflow: visible;
  background: transparent;

  --frameBleed: calc(6 * var(--u));
}

/* ì•„íŠ¸ ë ˆì´ì–´ */
.enemyArtCard::before{
  content:"";
  position:absolute;
  inset:0;
  background-image: var(--artImg);
  background-repeat: no-repeat;
  background-position: 50% 35%;
  background-size: calc(100% * var(--artZoom, 1.0)) auto;
  image-rendering: pixelated;
  z-index: 1;
}

/* í”„ë ˆì„ ë ˆì´ì–´ */
.enemyArtCard::after{
  content:"";
  position:absolute;
  inset: calc(-2 * var(--frameBleed));
  background-image: var(--frameImg);
  background-repeat:no-repeat;
  background-position:center;
  background-size: 100% 100%;
  image-rendering: pixelated;
  pointer-events:none;
  z-index: 5;
}

/* í•˜ë‹¨ ë¯¸ë‹ˆ HUD */
.enemyMiniHud{
  width: 70%;
  padding: calc(7 * var(--u) * var(--enemyUi)) calc(9 * var(--u) * var(--enemyUi));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.10);
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(calc(8 * var(--u)));
  -webkit-backdrop-filter: blur(calc(8 * var(--u)));
  display:flex;
  flex-direction:column;
  gap: calc(5 * var(--u) * var(--enemyUi));
  border-radius: calc(3 * var(--u));
  margin-top: -calc(10 * var(--u));
  z-index: 10;
}

.enemyIntentTopRow{
  display:flex;
  justify-content: center !important;
  align-items:center;
  gap: calc(8 * var(--u));
}

.enemyIntentIcon{
  font-size: calc(20 * var(--u) * var(--enemyUi));
  line-height: 1;
}

.enemyIntentDmg{
  font-size: calc(20 * var(--u) * var(--enemyUi));
  font-weight: 900;
  line-height: 1;
  white-space: nowrap;
}

.enemyIntentLine{
  font-size: calc(11 * var(--u) * var(--enemyUi));
  opacity: .92;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* HP ë¼ì¸ */
.enemyMiniHud .enemyHpLine{
  display:flex;
  flex-direction: row;
  align-items:center;
  gap: calc(8 * var(--u) * var(--enemyUi));
}
.enemyMiniHud .enemyHpText{
  font-size: calc(13 * var(--u) * var(--enemyUi));
  width: calc(78 * var(--u) * var(--enemyUi));
  flex: 0 0 auto;
  white-space: nowrap;
}
.enemyMiniHud .enemyHPOuter{
  flex: 1 1 auto;
  height: calc(7 * var(--u) * var(--enemyUi));
  border-radius: calc(999 * var(--u));
  overflow:hidden;
}
.enemyMiniHud .enemyHPFill{ height: 100%; }

/* ìƒíƒœ ì´ëª¨ì§€ ë¼ì¸(í‘œì‹œë§Œ, ì£¼ì„ì—ëŠ” ë¯¸ì‚¬ìš©) */
.enemyStatusEmojiRow{
  display:flex;
  flex-wrap: wrap;
  align-items: center;
  font-size: calc(10 * var(--u) * var(--enemyUi));
  gap: calc(3 * var(--u) * var(--enemyUi));
  min-height: calc(16 * var(--u) * var(--enemyUi));
}
.enemyStatusEmojiRow .stEmoji{
  line-height: 1.1;
  border: calc(1 * var(--u)) solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  padding: calc(1 * var(--u) * var(--enemyUi)) calc(3 * var(--u) * var(--enemyUi));
  border-radius: calc(7 * var(--u) * var(--enemyUi));
}



/* íŒ¨ì‹œë¸Œ ì•„ì´ì½˜ ë¼ì¸ */
.enemyPassiveRow{
  display:flex;
  justify-content:center;
  align-items:center;
  gap: calc(6 * var(--u) * var(--enemyUi));
  min-height: calc(14 * var(--u) * var(--enemyUi));
}
.enemyPassiveIcon{
  font-size: calc(13 * var(--u) * var(--enemyUi));
  line-height: 1;
  border: calc(1 * var(--u)) solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
  padding: calc(1 * var(--u) * var(--enemyUi)) calc(4 * var(--u) * var(--enemyUi));
  border-radius: calc(8 * var(--u) * var(--enemyUi));
}

/* ëŒ€ìƒ ì„ íƒ ì‹œ */
.enemyBanner.targetable{ cursor:pointer; }
.enemyBanner.untargetable{ cursor:not-allowed; opacity:.65; filter: grayscale(.20); }
.enemyBanner.untargetable .enemyMiniHud{ opacity: .85; }

/* í˜¸ë²„ ìƒì„¸ */
.enemyHoverDetail{
  display:none;
  position:absolute;
  left: calc(10 * var(--u)); right: calc(10 * var(--u));
  bottom: calc(10 * var(--u));
  transform: translateY(-calc(6 * var(--u)));
  opacity: 0;
  pointer-events: none;
  white-space: pre-wrap;
  font-size: calc(12 * var(--u));
  line-height: 1.35;
  padding: calc(10 * var(--u)) calc(12 * var(--u));
  border-radius: calc(5 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.86);
  -webkit-backdrop-filter: blur(calc(4 * var(--u)));
  backdrop-filter: blur(calc(4 * var(--u)));
  z-index: 50;
}
.enemyBanner:hover .enemyHoverDetail{ display:block; }

.enemyBanner.enemyCardWrap .enemyHoverDetail{
  left: -calc(18 * var(--u));
  right: -calc(18 * var(--u));
  top: -calc(10 * var(--u));
  bottom: -calc(10 * var(--u));
  transform: translateY(calc(14 * var(--u)));

  font-size: calc(14 * var(--u));
  padding: calc(14 * var(--u)) calc(16 * var(--u));
  border-radius: calc(10 * var(--u));

  max-height: min(40vh, calc(260 * var(--u)));
  overflow: auto;

  display: none;
  opacity: 0;
  pointer-events: none;

  box-shadow: 0 calc(22 * var(--u)) calc(70 * var(--u)) rgba(0,0,0,.60);
}
.enemyBanner.enemyCardWrap:hover .enemyHoverDetail{
  display: block;
  opacity: 1;
  transform: translateY(calc(-30 * var(--u)));
}
.enemyBanner.enemyCardWrap:hover .enemyMiniHud{ opacity: 0.18; }


/* =========================
   20) MAP (2-column, full-viewport)
   - ë§µ ë…¸ë“œ ì„ íƒ UI(ì§€ë„ + ì‚¬ì´ë“œ íŒ¨ë„)
   ========================= */
.nodeSelectWrap.mapNodeSelect{
  position: fixed !important;
  inset: auto !important;

  left: calc(var(--mapPanelCX) + var(--mapPanelDX)) !important;
  top:  calc(var(--mapPanelCY) + var(--mapPanelDY)) !important;
  transform: translate(-50%, 0%) !important;
  background: rgb(9,8,7) !important;
  border-radius: 5%;

  width: calc(var(--panelMaxWidthPx) * var(--u)) !important;
  max-height: calc(var(--mapPanelMaxHPx) * var(--u)) !important;

  display: flex !important;
  flex-direction: column !important;
  overflow: hidden !important;

  box-sizing: border-box !important;
  z-index: 52000 !important;
}

.mapNodeSelectBody{
  flex: 1 1 auto;
  min-height: 0;

  display: grid;
  grid-template-columns: minmax(0, 1fr) calc(var(--sideColWidthPx) * var(--u));
  gap: calc(var(--gridGapPx) * var(--u));

  margin-top: calc(3 * var(--u));
}

.mapNodeSelectMapCol{
  min-width: 0;
  min-height: 0;
  display: flex;
}

.mapNodeSelectSideCol{
  min-height: 0;
  overflow: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.mapNodeSelectSideCol::-webkit-scrollbar{ width:0; height:0; }

.mapNodeSelectMapCol .mapMiniBox,
.mapNodeSelect .mapMiniBox{
  flex: 1 1 auto;
  min-height: 0;

  display: flex;
  flex-direction: column;

  padding: calc(var(--boxPadPx) * var(--u)) !important;
  border-radius: calc(var(--boxRadiusPx) * var(--u)) !important;
  margin: 0 !important;
}

/* ìŠ¤í¬ë¡¤ëŸ¬: ì±„ìš°ê¸° + ì¤‘ì•™ */
.mapNodeSelectMapCol .mapMiniScroller,
.mapNodeSelect .mapMiniScroller{
  flex: 1 1 auto;
  min-height: calc(var(--mapScrollerMinHPx) * var(--u)) !important;
  overflow-x: auto !important;
  overflow-y: hidden !important;
  display: block !important;
  align-items: center !important;
  justify-content: center !important;
  scrollbar-width: none;
  -ms-overflow-style: none;
  border-radius: calc(var(--scrollerRadiusPx) * var(--u)) !important;

  background: var(--mapBgUrl) center/cover no-repeat !important;
}
.mapNodeSelect .mapMiniScroller::-webkit-scrollbar{ width:0; height:0; }

.mapNodeSelect .mapMiniViewport{
  width: 100%;
  height: 100%;

  overflow-x: auto;
  overflow-y: hidden;

  clip-path: inset(0 var(--pillarW) 0 var(--pillarW));
  padding-left: var(--pillarW);
  padding-right: var(--pillarW);
  box-sizing: border-box;

  scrollbar-width: none;
  -ms-overflow-style: none;
}
.mapNodeSelect .mapMiniViewport::-webkit-scrollbar{ width:0; height:0; }

.mapNodeSelectMapCol .mapMiniScroller svg,
.mapNodeSelect .mapMiniScroller svg{
  display: block !important;

  transform: scale(var(--mapSvgScale)) translate(var(--mapSvgDX), var(--mapSvgDY)) !important;
  transform-origin: top left !important;
}

.mapNodeSelectMapCol .mapMiniScroller svg path,
.mapNodeSelect .mapMiniScroller svg path{
  stroke-width: calc(1 * var(--u)) !important;
  stroke: rgb(255, 255, 255) !important;
}

.mapNodeSelectMapCol .mapMiniScroller svg circle,
.mapNodeSelect .mapMiniScroller svg circle{
  stroke-width: calc(3 * var(--u)) !important;
}

.mapNodeSelectMapCol .mapMiniScroller svg text,
.mapNodeSelect .mapMiniScroller svg text{
  font-size: calc(16 * var(--u)) !important;
  text-anchor: middle !important;
  dominant-baseline: central !important;
}

.mapDetailPanel{
  width: calc(685 * var(--u)) !important;
  max-height: calc(100vh - (calc(64 * var(--u)))) !important;
  overflow-y: auto !important;
  transform: translate(0%, 39%) !important;
}

.mapNodeSelect .nodeSelectHeader{
  height: auto !important;
  min-height: calc(40 * var(--u)) !important;
  padding-top: calc(15 * var(--u)) !important;
  padding-bottom: calc(0 * var(--u)) !important;
  padding-left: calc(40 * var(--u)) !important;
  padding-right: calc(40 * var(--u)) !important;
  overflow: visible !important;
}
.mapNodeSelect .nodeSelectHeaderRight button{
  margin-top: calc(2 * var(--u)) !important;
}


/* =========================
   21) TOASTS
   - í™”ë©´ ì¤‘ì•™ ê³ ì • + ìµœìƒë‹¨ ë ˆì´ì–´
   ========================= */
.toastLayer{
  position: fixed !important;
  z-index: calc(var(--zChrome) + 500) !important;

  left: var(--toastCX) !important;
  top:  var(--toastCY) !important;
  right: auto !important;
  bottom: auto !important;

  transform:
    translate(-50%, -50%)
    translate(
      calc(var(--toastDx) * var(--u)),
      calc(var(--toastDy) * var(--u))
    ) !important;

  display: flex;
  flex-direction: column-reverse;
  gap: var(--toastGap);
  align-items: center;
}

.toast{
  background: rgba(0,0,0,0.72);
  color: #fff;
  padding: var(--toastPadY) var(--toastPadX);
  border-radius: var(--toastR);
  font-size: var(--toastFont);
  line-height: 1.2;
  box-shadow: 0 calc(6 * var(--u)) calc(18 * var(--u)) rgba(0,0,0,0.35);
  max-width: min(var(--toastMaxW), 88vw);
}

.toast-gold{ border: calc(1 * var(--u)) solid rgba(255,215,0,0.35); }
.toast-warn{ border: calc(1 * var(--u)) solid rgba(255,120,120,0.35); }
.toast-relic{ border: calc(1 * var(--u)) solid rgba(120,200,255,0.35); }
.toast-info{ border: calc(1 * var(--u)) solid rgba(255,255,255,0.18); }


/* =========================
   22) SHOP COMPACT
   - ìƒì  íŒ¨ë„ ë‚´ë¶€ ë ˆì´ì•„ì›ƒ(ì¹´ë“œ/ì•„ì´í…œ/ì„œë¹„ìŠ¤)
   ========================= */
.choice-panel.shopPanel{
  width: var(--shopPanelW);
  overflow: hidden;
}

.shopContentRow{
  display:flex;
  gap: calc(14 * var(--u));
  margin-top: calc(10 * var(--u));
  align-items: stretch;
}

.shopLeftCol{
  flex: 1 1 auto;
  min-width: 0;
  display:flex;
  flex-direction: column;
  gap: calc(12 * var(--u));
}

/* ì¹´ë“œ 3x2 ê·¸ë¦¬ë“œ */
.shopCardsGrid{
  display:grid;
  grid-template-columns: repeat(3, var(--handCardW));
  gap: calc(12 * var(--u));
  justify-content: start;
  align-items: start;
}

.shopCardTile{
  display:flex;
  flex-direction: column;
  align-items: center;
  gap: calc(6 * var(--u));
  cursor: pointer;
  -webkit-user-select: none;
  user-select: none;
}
.shopCardTile.sold{ opacity: .35; cursor: default; }

.shopTilePrice{
  font-weight: 900;
  font-size: calc(12 * var(--u));
  opacity: .90;
}

/* í•˜ë‹¨: ì™¼ìª½ ì•„ì´í…œ / ì˜¤ë¥¸ìª½ ì„œë¹„ìŠ¤ */
.shopBottomRow{
  display:flex;
  gap: calc(14 * var(--u));
  align-items: flex-start;
  justify-content: flex-start;
}

/* ì•„ì´í…œ */
.shopItemsGrid{
  display:flex;
  gap: calc(10 * var(--u));
  flex-wrap: wrap;
}

.shopItemTile{
  width: var(--shopItemSize);
  aspect-ratio: 1/1;
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.30);
  overflow: hidden;
  display:flex;
  flex-direction: column;
  align-items:center;
  justify-content:center;
  gap: calc(6 * var(--u));
  cursor:pointer;
}
.shopItemTile.sold{ opacity:.35; cursor:default; }
.shopItemTile img{
  width: var(--shopItemIcon);
  height: var(--shopItemIcon);
  object-fit: contain;
  transform: scale(1.1);
  image-rendering: pixelated;
}

/* ì„œë¹„ìŠ¤ ë²„íŠ¼ 2x2 */
.shopSvcGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--shopSvcGap);
  width: var(--shopSvcW);
}
.shopSvcTile button{
  width: 100%;
  padding: calc(7 * var(--u)) calc(8 * var(--u));
  font-size: calc(12 * var(--u));
  border-radius: 0;
}
.shopSvcNote{
  margin-top: calc(4 * var(--u));
  font-size: calc(10 * var(--u));
  opacity: .85;
  text-align:center;
}


/* =========================
   23) GLOBAL ITEM TOOLTIP
   - ì»¤ì„œ í˜¸ë²„ ì‹œë§Œ ë³´ì´ëŠ” íˆ´íŒ(íŠ¸ë ˆì´ ë‚´ë¶€ ê³ ì • íˆ´íŒì€ ì œê±°ë¨)
   ========================= */
.itemHoverTip{
  display: block !important;
  opacity: 0;
  visibility: hidden;
  transform: translateY(calc(-4 * var(--u)));
  transition: opacity 90ms ease, transform 90ms ease;
  max-width: calc(260 * var(--u));
  padding: calc(10 * var(--u));
  border: calc(1 * var(--u)) solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.72);
  backdrop-filter: blur(calc(4 * var(--u)));
  -webkit-backdrop-filter: blur(calc(4 * var(--u)));
}
.itemHoverTip.show{
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}


/* =========================
   24) MOBILE (placeholder)
   - í˜„ì¬ ë¹„ì›Œë‘ 
   ========================= */
/* keep empty for now */